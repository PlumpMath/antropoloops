(ns dat00.mock)


(defn to-sec [l] (long (/ l 1000)))



(def readed
  {{:clip 4, :track 1} {:lugar {:lugar "China", :coordX 995, :coordY 396, :pais ""}, :song {:nombreArchivo "SPOAMR 07 Thinking of an Old Friend", :artista "Chen Lei-Shi", :album "Spring Night on a Moonlit River", :titulo "Thinking of an Old Friend", :fecha "1984", :lugar "China", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 94.874504, :loopend 1, :color-s 56.818653, :clip 4, :track 1, :nombre "SPOAMR 07 Thinking of an Old Friend", :volume 1, :color-h 148.72421}, {:clip 3, :track 1} {:lugar {:lugar "China", :coordX 995, :coordY 396, :pais ""}, :song {:nombreArchivo "SPOAMR 07 Thinking of an Old Friend", :artista "Chen Lei-Shi", :album "Spring Night on a Moonlit River", :titulo "Thinking of an Old Friend", :fecha "1984", :lugar "China", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 86.69683, :loopend 1, :color-s 62.814034, :clip 3, :track 1, :nombre "SPOAMR 07 Thinking of an Old Friend", :volume 1, :color-h 156.1793}, {:clip 2, :track 0} {:lugar {:lugar "Pakistan", :coordX 840, :coordY 411, :pais ""}, :song {:nombreArchivo "05-Danse Du Sind", :artista "Khamisu Khan", :album "L'Algoza Du Sind", :titulo "Danse Du Sind", :fecha "1979", :lugar "Pakistan", :antropoloop "danse du satan"}, :solo 0, :color-b 88.613304, :loopend 1, :color-s 61.14203, :clip 2, :track 0, :nombre "05-Danse Du Sind", :volume 1, :color-h 111.55687}, {:clip 3, :track 0} {:lugar {:lugar "Pakistan", :coordX 840, :coordY 411, :pais ""}, :song {:nombreArchivo "05-Danse Du Sind", :artista "Khamisu Khan", :album "L'Algoza Du Sind", :titulo "Danse Du Sind", :fecha "1979", :lugar "Pakistan", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 81.77747, :loopend 1, :color-s 99.059975, :clip 3, :track 0, :nombre "05-Danse Du Sind", :volume 1, :color-h 109.25082}, {:clip 2, :track 3} {:lugar {:lugar "Jamaica", :coordX 299, :coordY 454, :pais ""}, :song {:nombreArchivo "04 bla, bla, bla", :artista "Toots & The Maytals", :album "Sweet & Dandy '68", :titulo "bla, bla, bla", :fecha "1968", :lugar "Jamaica", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 97.996635, :loopend 1, :color-s 73.329956, :clip 2, :track 3, :nombre "04 bla, bla, bla", :volume 1, :color-h 333.30963}, {:clip 1, :track 1} {:lugar {:lugar "Guinea", :coordX 552, :coordY 487, :pais ""}, :song {:nombreArchivo "02 - I Ya Polma (Moral Song)", :artista "Antoine Sagno, Cécé Kolié, Foromo Gbamou, Foromo Onikouyanou, Germain Doparogui, Guo-Guo Camara, Kokoli Haba, Mariba Lamassigui & Siba Fassou", :album "Guinée. Musique Des Kpelle. Chants Polyphoniques, Trompes Et Percussions  ", :titulo "I Ya Polma (Moral Song)", :fecha "1998", :lugar "Guinea", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 81.554665, :loopend 1, :color-s 79.60463, :clip 1, :track 1, :nombre "02 - I Ya Polma (Moral Song)", :volume 1, :color-h 157.04805}, {:clip 0, :track 0} {:lugar {:lugar "Pakistan", :coordX 840, :coordY 411, :pais ""}, :song {:nombreArchivo "05-Danse Du Sind", :artista "Khamisu Khan", :album "L'Algoza Du Sind", :titulo "Danse Du Sind", :fecha "1979", :lugar "Pakistan", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 91.43731, :loopend 1, :color-s 63.533134, :clip 0, :track 0, :nombre "05-Danse Du Sind", :volume 1, :color-h 119.44068}, {:clip 2, :track 2} {:lugar {:lugar "Nigeria", :coordX 626, :coordY 459, :pais ""}, :song {:nombreArchivo "04 Ivba Ni Kalo-1", :artista "Miki Jaga & His Dance Band", :album "Miki Jaga & His Dance Band", :titulo "Ivba Ni Kalo", :fecha "1983", :lugar "Nigeria", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 83.61225, :loopend 1, :color-s 53.32318, :clip 2, :track 2, :nombre "04 Ivba Ni Kalo-1", :volume 1, :color-h 307.61374}, {:clip 3, :track 3} {:lugar {:lugar "Jamaica", :coordX 299, :coordY 454, :pais ""}, :song {:nombreArchivo "04 bla, bla, bla", :artista "Toots & The Maytals", :album "Sweet & Dandy '68", :titulo "bla, bla, bla", :fecha "1968", :lugar "Jamaica", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 92.62296, :loopend 1, :color-s 75.504845, :clip 3, :track 3, :nombre "04 bla, bla, bla", :volume 1, :color-h 340.38474}, {:clip 4, :track 4} {:lugar {:lugar "Japon", :coordX 1092, :coordY 375, :pais ""}, :song {:nombreArchivo "Nipponia 02 Ozatsuma", :artista "Hirokazu Sugiura", :album "Japan: Traditional Vocal and Instrumental Music", :titulo "Ozatsuma", :fecha "1976", :lugar "Japon", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 95.26095, :loopend 1, :color-s 76.424286, :clip 4, :track 4, :nombre "Nipponia 02 Ozatsuma", :volume 1, :color-h 196.36572}, {:clip 1, :track 0} {:lugar {:lugar "Pakistan", :coordX 840, :coordY 411, :pais ""}, :song {:nombreArchivo "05-Danse Du Sind", :artista "Khamisu Khan", :album "L'Algoza Du Sind", :titulo "Danse Du Sind", :fecha "1979", :lugar "Pakistan", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 84.569084, :loopend 1, :color-s 87.04112, :clip 1, :track 0, :nombre "05-Danse Du Sind", :volume 1, :color-h 113.56679}, {:clip 3, :track 2} {:lugar {:lugar "Nigeria", :coordX 626, :coordY 459, :pais ""}, :song {:nombreArchivo "04 Ivba Ni Kalo-1", :artista "Miki Jaga & His Dance Band", :album "Miki Jaga & His Dance Band", :titulo "Ivba Ni Kalo", :fecha "1983", :lugar "Nigeria", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 88.74506, :loopend 1, :color-s 66.31914, :clip 3, :track 2, :nombre "04 Ivba Ni Kalo-1", :volume 1, :color-h 313.12158}, {:clip 0, :track 3} {:lugar {:lugar "Republica Centroafricana", :coordX 671, :coordY 503, :pais ""}, :song {:nombreArchivo "B5 Solo de femme roucoule", :artista "VA", :album "[LD765] Musiques Banda - République Centrafricaine", :titulo "B5 Solo de femme; roucoulé", :fecha "1971", :lugar "Republica Centroafricana", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 89.00986, :loopend 1, :color-s 91.119705, :clip 0, :track 3, :nombre "B5 Solo de femme roucoule", :volume 1, :color-h 344.84366}, {:clip 2, :track 5} {:lugar {:lugar "India-Rajasthan", :coordX 862, :coordY 418, :pais "India"}, :song {:nombreArchivo "3-03 Bageshwari [1964] 2'55", :artista "Kishori Amonkar", :album "[EALP1453-54] Festival of India Presents - The Great Tradition of Masters of Music", :titulo "3-03 Bageshwari [1964] 2'55", :fecha "1964", :lugar "India-Rajasthan", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 85.92345, :loopend 1, :color-s 71.72304, :clip 2, :track 5, :nombre "3-03 Bageshwari [1964] 2'55", :volume 1, :color-h 234.23041}, {:clip 4, :track 7} {:lugar {:lugar "Venezuela", :coordX 341, :coordY 504, :pais ""}, :song {:nombreArchivo "04 - Cuentos De Becerrero", :artista "Simón Díaz", :album "50 Años De Vida Artística", :titulo "Cuentos De Becerrero", :fecha "2003", :lugar "Venezuela", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 92.2458, :loopend 1, :color-s 50.993, :clip 4, :track 7, :nombre "04 - Cuentos De Becerrero", :volume 1, :color-h 50.811527}, {:clip 0, :track 2} {:lugar {:lugar "Kenia", :coordX 737, :coordY 534, :pais ""}, :song {:nombreArchivo "B4 - Pokot Witch Doctor", :artista "Various", :album "Africa:Witchcraft & Ritual Music", :titulo "Pokot Witch Doctor", :fecha "1975", :lugar "Kenia", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 85.81784, :loopend 1, :color-s 92.12239, :clip 0, :track 2, :nombre "B4 - Pokot Witch Doctor", :volume 1, :color-h 301.66324}, {:clip 2, :track 4} {:lugar {:lugar "Burundi", :coordX 706, :coordY 550, :pais ""}, :song {:nombreArchivo "A5 Idingiti 2'35", :artista "VA", :album "[VPA 8137] Musica del Burundi - Music from Burundi (P.1971)", :titulo "A5 Idingiti 2'35", :fecha "1971", :lugar "Burundi", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 96.7154, :loopend 1, :color-s 72.335144, :clip 2, :track 4, :nombre "A5 Idingiti 2'35", :volume 1, :color-h 203.99341}, {:clip 4, :track 6} {:lugar {:lugar "georgia", :coordX 287, :coordY 396, :pais "Estados Unidos"}, :song {:nombreArchivo "Nobody's fault but mine", :artista "Rev.Pearly Brown", :album "Country Spirituals", :titulo "Nobody's fault but mine", :fecha "1961", :lugar "georgia", :antropoloop "danse du satan"}, :solo 0, :color-b 97.096085, :loopend 1, :color-s 74.45154, :clip 4, :track 6, :nombre "Nobody's fault but mine", :volume 1, :color-h 30.583769}, {:clip 1, :track 2} {:lugar {:lugar "Nigeria", :coordX 626, :coordY 459, :pais ""}, :song {:nombreArchivo "04 Ivba Ni Kalo-1", :artista "Miki Jaga & His Dance Band", :album "Miki Jaga & His Dance Band", :titulo "Ivba Ni Kalo", :fecha "1983", :lugar "Nigeria", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 82.31905, :loopend 1, :color-s 96.32975, :clip 1, :track 2, :nombre "04 Ivba Ni Kalo-1", :volume 1, :color-h 301.4961}, {:clip 3, :track 4} {:lugar {:lugar "Peninsula Sinai", :coordX 717, :coordY 405, :pais ""}, :song {:nombreArchivo "11 - Sid El 'Arab", :artista "VA", :album "Music of the South Sinai Bedouins", :titulo "Sid El 'Arab", :fecha "1998", :lugar "Peninsula Sinai", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 95.74961, :loopend 1, :color-s 63.884743, :clip 3, :track 4, :nombre "11 - Sid El 'Arab", :volume 1, :color-h 199.06737}, {:clip 0, :track 5} {:lugar {:lugar "India-Rajasthan", :coordX 862, :coordY 418, :pais "India"}, :song {:nombreArchivo "3-03 Bageshwari [1964] 2'55", :artista "Kishori Amonkar", :album "[EALP1453-54] Festival of India Presents - The Great Tradition of Masters of Music", :titulo "3-03 Bageshwari [1964] 2'55", :fecha "1964", :lugar "India-Rajasthan", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 86.84736, :loopend 1, :color-s 79.81054, :clip 0, :track 5, :nombre "3-03 Bageshwari [1964] 2'55", :volume 1, :color-h 235.40509}, {:clip 2, :track 7} {:lugar {:lugar "georgia", :coordX 287, :coordY 396, :pais "Estados Unidos"}, :song {:nombreArchivo "Nobody's fault but mine", :artista "Rev.Pearly Brown", :album "Country Spirituals", :titulo "Nobody's fault but mine", :fecha "1961", :lugar "georgia", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 84.7481, :loopend 1, :color-s 86.04373, :clip 2, :track 7, :nombre "Nobody's fault but mine", :volume 1, :color-h 59.380722}, {:clip 0, :track 4} {:lugar {:lugar "Papua-Nueva Guinea", :coordX 1144, :coordY 560, :pais ""}, :song {:nombreArchivo "Church Service In Nalka", :artista "Various", :album "Irian Jaya: Disc Six", :titulo "Church Service In Nalka", :fecha "1973", :lugar "Papua-Nueva Guinea", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 88.294685, :loopend 1, :color-s 69.48064, :clip 0, :track 4, :nombre "Church Service In Nalka", :volume 1, :color-h 203.88962}, {:clip 1, :track 5} {:lugar {:lugar "India-Rajasthan", :coordX 862, :coordY 418, :pais "India"}, :song {:nombreArchivo "3-03 Bageshwari [1964] 2'55", :artista "Kishori Amonkar", :album "[EALP1453-54] Festival of India Presents - The Great Tradition of Masters of Music", :titulo "3-03 Bageshwari [1964] 2'55", :fecha "1964", :lugar "India-Rajasthan", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 95.96566, :loopend 1, :color-s 81.54765, :clip 1, :track 5, :nombre "3-03 Bageshwari [1964] 2'55", :volume 1, :color-h 231.87823}, {:clip 2, :track 6} {:lugar {:lugar "Tuva", :coordX 912, :coordY 310, :pais "Rusia"}, :song {:nombreArchivo "04  - Ogbeler", :artista "folkblog.in.ua - Tuva Ensemble", :album "Tuvinian Singers & Musicians - Chöömej: Throat-Singing From The Center Of Asia", :titulo "Ögbeler", :fecha "1993", :lugar "Tuva", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 94.213356, :loopend 1, :color-s 71.02925, :clip 2, :track 6, :nombre "04  - Ogbeler", :volume 1, :color-h 31.836023}, {:clip 3, :track 7} {:lugar {:lugar "Venezuela", :coordX 341, :coordY 504, :pais ""}, :song {:nombreArchivo "04 - Cuentos De Becerrero", :artista "Simón Díaz", :album "50 Años De Vida Artística", :titulo "Cuentos De Becerrero", :fecha "2003", :lugar "Venezuela", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 92.1152, :loopend 1, :color-s 61.813313, :clip 3, :track 7, :nombre "04 - Cuentos De Becerrero", :volume 1, :color-h 57.731792}, {:clip 1, :track 4} {:lugar {:lugar "Gagauzia", :coordX 692, :coordY 333, :pais "Moldavia"}, :song {:nombreArchivo "muzyka gagauzov a06", :artista "Lazarev, Stepan", :album "13562 & 3 muzyka gagauzov", :titulo "muzyka gagauzov a06", :fecha "1980", :lugar "Gagauzia", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 93.26657, :loopend 1, :color-s 86.71347, :clip 1, :track 4, :nombre "muzyka gagauzov a06", :volume 1, :color-h 200.91756}, {:clip 3, :track 6} {:lugar {:lugar "Tuva", :coordX 912, :coordY 310, :pais "Rusia"}, :song {:nombreArchivo "04  - Ogbeler", :artista "folkblog.in.ua - Tuva Ensemble", :album "Tuvinian Singers & Musicians - Chöömej: Throat-Singing From The Center Of Asia", :titulo "Ögbeler", :fecha "1993", :lugar "Tuva", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 96.42578, :loopend 1, :color-s 98.71765, :clip 3, :track 6, :nombre "04  - Ogbeler", :volume 1, :color-h 36.139366}, {:clip 0, :track 7} {:lugar {:lugar "Venezuela", :coordX 341, :coordY 504, :pais ""}, :song {:nombreArchivo "04 - Cuentos De Becerrero", :artista "Simón Díaz", :album "50 Años De Vida Artística", :titulo "Cuentos De Becerrero", :fecha "2003", :lugar "Venezuela", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 98.9987, :loopend 1, :color-s 96.26496, :clip 0, :track 7, :nombre "04 - Cuentos De Becerrero", :volume 1, :color-h 62.241806}, {:clip 0, :track 6} {:lugar {:lugar "Tuva", :coordX 912, :coordY 310, :pais "Rusia"}, :song {:nombreArchivo "04  - Ogbeler", :artista "folkblog.in.ua - Tuva Ensemble", :album "Tuvinian Singers & Musicians - Chöömej: Throat-Singing From The Center Of Asia", :titulo "Ögbeler", :fecha "1993", :lugar "Tuva", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 99.39406, :loopend 1, :color-s 75.92251, :clip 0, :track 6, :nombre "04  - Ogbeler", :volume 1, :color-h 36.460083}, {:clip 1, :track 7} {:lugar {:lugar "Venezuela", :coordX 341, :coordY 504, :pais ""}, :song {:nombreArchivo "04 - Cuentos De Becerrero", :artista "Simón Díaz", :album "50 Años De Vida Artística", :titulo "Cuentos De Becerrero", :fecha "2003", :lugar "Venezuela", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 98.903, :loopend 1, :color-s 63.809357, :clip 1, :track 7, :nombre "04 - Cuentos De Becerrero", :volume 1, :color-h 64.489456}, {:clip 1, :track 6} {:lugar {:lugar "Arnhem Land", :coordX 1102, :coordY 589, :pais "Australia"}, :song {:nombreArchivo "07 Brolga Bird Clan Songs", :artista "Various", :album "Australia. Aboriginal Music", :titulo "Brolga Bird Clan Songs", :fecha "2013", :lugar "Arnhem Land", :antropoloop "danse du satan"}, :state 1, :solo 0, :color-b 85.93913, :loopend 1, :color-s 78.670975, :clip 1, :track 6, :nombre "07 Brolga Bird Clan Songs", :volume 1, :color-h 28.66411}})

(def history
  '([1398423004372 0 2 :IN] [1398423012341 0 3 :IN] [1398423022324 0 4 :IN] [1398423030369 0 7 :IN] [1398423062340 0 0 :IN] [1398423070341 1 7 :IN] [1398423070341 0 7 :OUT] [1398423078317 1 4 :IN] [1398423078318 0 4 :OUT] [1398423094367 1 0 :IN] [1398423094368 0 0 :OUT] [1398423096329 1 7 :OUT] [1398423110348 1 2 :IN] [1398423110348 0 2 :OUT] [1398423122360 1 1 :IN] [1398423130357 0 6 :IN] [1398423140320 2 3 :IN] [1398423140321 0 3 :OUT] [1398423156335 2 2 :IN] [1398423156335 1 2 :OUT] [1398423166325 2 4 :IN] [1398423166325 1 4 :OUT] [1398423180329 0 5 :IN] [1398423182318 0 6 :OUT] [1398423196325 1 6 :IN] [1398423202337 1 7 :IN] [1398423210354 1 5 :IN] [1398423210354 0 5 :OUT] [1398423218334 2 5 :IN] [1398423218334 1 5 :OUT] [1398423248348 3 1 :IN] [1398423248350 1 1 :OUT] [1398423248351 0 0 :IN] [1398423248352 1 0 :OUT] [1398423254354 2 3 :OUT] [1398423254356 2 2 :OUT] [1398423256335 1 6 :OUT] [1398423256335 1 7 :OUT] [1398423256336 2 5 :OUT] [1398423256337 2 4 :OUT] [1398423264314 2 7 :IN] [1398423272334 3 4 :IN] [1398423282323 3 3 :IN] [1398423290310 3 2 :IN] [1398423298361 3 7 :IN] [1398423298361 2 7 :OUT] [1398423306315 3 0 :IN] [1398423306317 0 0 :OUT] [1398423320362 0 6 :IN] [1398423332332 2 6 :IN] [1398423332333 0 6 :OUT] [1398423340350 3 6 :IN] [1398423340350 2 6 :OUT] [1398423348351 2 6 :IN] [1398423348352 3 6 :OUT] [1398423356319 3 6 :IN] [1398423356320 2 6 :OUT] [1398423364350 0 5 :IN] [1398423374330 2 5 :IN] [1398423374332 0 5 :OUT]        [1398423390350 4 4 :IN] [1398423390354 3 4 :OUT] [1398423390355 4 1 :IN] [1398423390356 3 1 :OUT] [1398423392318 3 3 :OUT] [1398423392319 3 2 :OUT] [1398423394349 2 5 :OUT] [1398423394351 3 6 :OUT] [1398423394351 3 7 :OUT] [1398423394353 3 0 :OUT] [1398423402318 3 7 :IN] [1398423402319 3 6 :IN] [1398423410329 4 7 :IN] [1398423410330 3 7 :OUT] [1398423418341 4 7 :OUT] [1398423422351 4 1 :OUT] [1398423422353 3 6 :OUT] [1398423422354 4 4 :OUT]))

(def start-on (ffirst history))

(def end-on (apply max (map first history)))

(defn get-all-in [place] (map (fn [[ time c t mode]] [ t c  mode  (to-sec (- time start-on)) ;(get-in  (get readed { :clip c :track t}) place)
                                                     ]) history))

(def duration (to-sec (- end-on start-on)))
(def mins (long (/ duration 60)))
(get-all-in [:lugar :lugar])
(def in-c
  (filter (fn [[t c x _ _]] (= :IN x)) (get-all-in [:lugar :lugar])))
(def out-c
  (filter (fn [[t c x _ _]] (= :OUT x)) (get-all-in [:lugar :lugar])))
(count in-c) ;46
(count out-c) ;39

(defn id- [-col] (map (fn [ [x y & more]] [ (str x "-" y) (apply hash-map  more)]) -col))




(def ins (id- in-c))


(def outs (id- out-c))


(defn splitea [x y]
  (let [base (split-with (fn [[i m]](not=  i x)) y)
        s (second  base)]


    [ (second (first s)) (concat (first base) (next s)) ]

    )
  )

(def res (loop [stock []
        ins ins
        outs outs]
   (if-not (nil? (next ins))
     (let [[the-k the-m] (first ins)
           the-v  (splitea the-k outs)]

       (recur (conj stock [ the-k (merge the-m (first the-v))])
              (next ins)
              (second the-v))
       )

     stock)

   ))

(filter (fn [[x y]] (nil? (:OUT y))) res)

(filter (fn [[x y]] (= x "5-2")) res )
(filter (fn [[x y]] (= x "5-2")) ins)
(filter (fn [[x y]] (= x "5-2")) outs)
